\newcounter{linkcount}
\newcounter{linktotal}

\newcommand{\countLinks}[1]{%
    \setcounter{linkcount}{0}%
    \setcounter{linktotal}{0}%
    \renewcommand*{\do}[1]{\stepcounter{linktotal}}%
    \docsvlist{#1}%
}

\newcommand{\createHyperlinks}[1]{%
    \ifthenelse{\equal{#1}{-}}{-}{%
        \countLinks{#1}%
        \renewcommand*{\do}[1]{%
            \stepcounter{linkcount}%
            \hyperlink{FA##1}{FA##1}%
            \ifnum\value{linkcount}<\value{linktotal},\ \fi%
        }%
        \docsvlist{#1}%
    }%
}

% Optional: für NFA-Referenzen
\newcommand{\createHyperlinksNFA}[1]{%
    \ifthenelse{\equal{#1}{-}}{-}{%
        \countLinks{#1}%
        \renewcommand*{\do}[1]{%
            \stepcounter{linkcount}%
            \hyperlink{NFA##1}{NFA##1}%
            \ifnum\value{linkcount}<\value{linktotal},\ \fi%
        }%
        \docsvlist{#1}%
    }%
}

% Helfer: Abhängigkeits-Zeile nur bei Inhalt rendern
\newcommand{\MaybeDepsRow}[1]{%
    \ifstrempty{#1}{%
        Abhängigkeiten: & -
    }{%
        \ifdefstrequal{#1}{-}{}{%
            Abhängigkeiten: & \createHyperlinks{#1} \\
        }%
    }%
}

% ======= Layout für die Requirement-Box =======
\makeatletter
\newlength{\reqLabelWidth}
\setlength{\reqLabelWidth}{3cm}

\newsavebox{\req@box}
\newcommand{\reqTable}[4]{%
    \par\smallskip\noindent
    \setlength{\fboxsep}{6pt}%
    \setlength{\fboxrule}{0.6pt}%
    \begin{lrbox}{\req@box}%
    \begin{minipage}{\dimexpr\linewidth-2\fboxsep-2\fboxrule\relax}
    \phantomsection\hypertarget{FA#1}{}
    {\large\textbf{\textcolor{accent}{\faIcon{tasks}}\,FA#1 — #2}}\par
    \vspace{4pt}{\color{accent}\hrule height 0.6pt}\vspace{4pt}

    \renewcommand{\arraystretch}{1}%
    \setlength{\extrarowheight}{2pt}%
    {\rowcolors{1}{background}{muted}
    \begin{tabularx}{\linewidth}{>{\bfseries}p{\reqLabelWidth} X}
    %ID:             & \texttt{FA#1} \\
    %Titel:          & #2 \\
    Beschreibung:   & #3 \\
    \MaybeDepsRow{#4}
    \end{tabularx}
    }
    \end{minipage}
    \end{lrbox}%
    \fcolorbox{accent}{background}{\usebox{\req@box}}%
    \par\smallskip
}
\makeatother