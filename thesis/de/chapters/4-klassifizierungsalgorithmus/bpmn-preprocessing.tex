\section{BPMN Preprocessing}\label{sec:bpmn-preprocessing}

Ziel der Vorverarbeitung (Preprocessing) ist es, für jedes Flow-Element einen \emph{strukturierten Kontext} zu erzeugen. Dieser Kontext umfasst die eigenen Attribute, wie \texttt{id}, \texttt{name} und \texttt{documentation}, sowie die Beziehungen zu anderen Elementen im \ac{BPMN}-Diagramm. Dazu gehören vorangehende und nachfolgende Flow-Elemente, Datenobjekte, assoziierte Elemente, sowie Informationen über den Pool und die Lane, in denen sich das Element befindet. Das Parsen des \ac{BPMN}-XML erfolgt mit der \emph{Camunda BPMN Model API}, die das XML in ein Objektmodell überführt \cite{camunda-bpmn-model-api, camunda-bpmn-model-read}. Auf dieser Basis werden die relevanten Informationen extrahiert und in der Datenklasse \texttt{BpmnElement} strukturiert abgelegt. Die Datenklasse ist in Listing \ref{lst:bpmn-element-class} zu sehen. Dadurch entsteht für jedes Flow-Element ein umfassender Kontext, der später im Prompt genutzt wird, um dem \ac{LLM} alle notwendigen Informationen strukturiert bereitzustellen. Außerdem werden durch das Format Tokens eingespart, da irrelevante Informationen, wie die Positionen der Elemente im XML, weggelassen werden. In Abbildung \ref{fig:architecture-diagram} ist dieser Schritt über die Aktivität \enquote{Kontext aller Elemente aufbauen} dargestellt.

\begin{lstlisting}[language=Kotlin,caption={Interne \ac{BPMN}-Repräsentation je Flow-Element.},label={lst:bpmn-element-class}]
data class BpmnElement(
   val type: String,
   val id: String,
   val name: String? = null,
   val documentation: String? = null,
   val poolName: String? = null,
   val laneName: String? = null,
   val outgoingFlowElementIds: List<String> = emptyList(),
   val incomingFlowElementIds: List<String> = emptyList(),
   val outgoingMessageFlowsToElementIds: List<String> = emptyList(),
   val incomingMessageFlowsFromElementIds: List<String> = emptyList(),
   val incomingDataFromElementIds: List<String> = emptyList(),
   val outgoingDataToElementIds: List<String> = emptyList(),
   val associatedElementIds: List<String> = emptyList()
)
\end{lstlisting}